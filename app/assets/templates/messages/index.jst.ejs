<h1 class="messages-header">All Messages</h1>

<ul class="messages">
  <h4 class="received-msg-header">Received Messages</h4>
  <% messages.each(function(msg){ %>
    <% var sent = false %>
    <% if(msg.get("receiver_id") === OkStupid.currentUser.id){ %>
      <% sent = true %>
      <ul class="received-msg">
        <img src="<%= msg.sender().escape("image_url") %>" alt="" />
        <li class="msg"><strong>From</strong>: <a href="#profiles/<%= msg.sender().get("id") %>"><%= msg.sender().escape("username") %></a></li>
        <li class="msg"><strong>Title</strong>: <%= msg.escape("title") %></li>
        <li class="msg"><strong>Body</strong>: <%= msg.escape("body") %></li>
        <li class="msg"><strong>Sent</strong>: <%= new Date(msg.escape("created_at")) %></li>
      </ul>
    <% } %>
    <% if(!sent){ %>
      <ul class="received-msg">
        "You don't seem to have any messages."
      </ul>
    <% } %>
  <% }) %>
  <% var received = false %>
  <h4 class="sent-msg-header">Sent Messages</h4>
  <% messages.each(function(msg){ %>
    <% if(msg.get("sender_id") === OkStupid.currentUser.id){ %>
      <% received = true %>
      <ul class="sent-msg">
        <img src="<%= msg.receiver().escape("image_url") %>" alt="" />
        <li class="msg"><strong>To</strong>: <a href="#profiles/<%= msg.receiver().get("id") %>"><%= msg.receiver().escape("username") %></a></li>
        <li class="msg"><strong>Title</strong>: <%= msg.escape("title") %></li>
        <li class="msg"><strong>Body</strong>: <%= msg.escape("body") %></li>
        <li class="msg"><strong>Sent</strong>: <%= new Date(msg.escape("created_at")) %></li>
      </ul>
    <% } %>
    <% if(!received){ %>
      <ul class="sent-msg">
        "You don't seem to have sent any messages."
      </ul>
    <% } %>
  <% }) %>
</ul>
